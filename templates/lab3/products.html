{% extends "base.html" %}

{% block lab %}Лабораторная работа 3{% endblock %}

{% block style %}
<style>
    .products-container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
    }
    
    .search-form {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
        border-left: 4px solid #4a90e2;
    }
    
    .price-inputs {
        display: flex;
        gap: 15px;
        align-items: center;
        flex-wrap: wrap;
    }
    
    .price-group {
        display: flex;
        flex-direction: column;
    }
    
    .price-group label {
        font-weight: bold;
        margin-bottom: 5px;
        color: #333;
    }
    
    .price-group input {
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 16px;
        width: 150px;
    }
    
    .buttons {
        display: flex;
        gap: 10px;
        margin-top: 15px;
    }
    
    .search-btn {
        background: #4a90e2;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
    }
    
    .reset-btn {
        background: #6c757d;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        text-decoration: none;
    }
    
    .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .product-card {
        border: 1px solid #e1e5e9;
        border-radius: 8px;
        padding: 15px;
        background: white;
        transition: transform 0.2s;
    }
    
    .product-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .product-name {
        font-size: 18px;
        font-weight: bold;
        color: #333;
        margin-bottom: 8px;
    }
    
    .product-price {
        font-size: 20px;
        font-weight: bold;
        color: #2c5f2d;
        margin-bottom: 10px;
    }
    
    .product-details {
        color: #666;
        font-size: 14px;
        line-height: 1.4;
    }
    
    .results-info {
        margin-bottom: 20px;
        padding: 10px;
        background: #e8f5e8;
        border-radius: 4px;
        border-left: 4px solid #4CAF50;
    }
    
    .no-results {
        text-align: center;
        padding: 40px;
        color: #666;
        font-size: 18px;
    }
    
    .price-hint {
        font-size: 12px;
        color: #666;
        margin-top: 3px;
    }
    
    .error {
        color: #d40000;
        font-size: 14px;
        margin-top: 5px;
        font-weight: bold;
    }
</style>
{% endblock %}

{% block main %}
<div class="products-container">
    <h1>Поиск смартфонов</h1>
    
    <div class="search-form">
        <form action="/lab3/products">
            <div class="price-inputs">
                <div class="price-group">
                    <label for="min_price">Минимальная цена:</label>
                    <input type="number" id="min_price" name="min_price" 
                        value="{{ min_price or '' }}" 
                        placeholder="{{ min_price_all }}"
                        min="0">
                    {% if errors and errors.min_price %}
                        <div class="error">{{ errors.min_price }}</div>
                    {% else %}
                        <div class="price-hint">Мин: {{ min_price_all }} руб.</div>
                    {% endif %}
                </div>
                
                <div class="price-group">
                    <label for="max_price">Максимальная цена:</label>
                    <input type="number" id="max_price" name="max_price" 
                        value="{{ max_price or '' }}" 
                        placeholder="{{ max_price_all }}"
                        min="0">
                    {% if errors and errors.max_price %}
                        <div class="error">{{ errors.max_price }}</div>
                    {% else %}
                        <div class="price-hint">Макс: {{ max_price_all }} руб.</div>
                    {% endif %}
                </div>
            </div>
            
            <div class="buttons">
                <button type="submit" class="search-btn">Искать</button>
                <a href="/lab3/products?reset=1" class="reset-btn">Сброс</a>
            </div>
        </form>
    </div>

    {% if min_price or max_price %}
    <div class="results-info">
        <strong>Найдено товаров:</strong> {{ products_count }} из {{ all_products_count }}
        {% if min_price and max_price %}
            (в диапазоне {{ min_price }} - {{ max_price }} руб.)
        {% elif min_price %}
            (от {{ min_price }} руб.)
        {% elif max_price %}
            (до {{ max_price }} руб.)
        {% endif %}
    </div>
    {% else %}
    <div class="results-info">
        <strong>Все товары:</strong> {{ all_products_count }} смартфонов
    </div>
    {% endif %}

    {% if products %}
    <div class="products-grid">
        {% for product in products %}
        <div class="product-card">
            <div class="product-name">{{ product.name }}</div>
            <div class="product-price">{{ product.price }} руб.</div>
            <div class="product-details">
                <strong>Бренд:</strong> {{ product.brand }}<br>
                <strong>Цвет:</strong> {{ product.color }}<br>
                <strong>Память:</strong> {{ product.storage }}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="no-results">
        Не найдено ни одного товара в выбранном диапазоне цен
    </div>
    {% endif %}
</div>
{% endblock %}